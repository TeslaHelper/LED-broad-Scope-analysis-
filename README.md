# LED Broad-Scope Analysis

## Overview
This project processes and analyzes Spectral Power Distribution (SPD) data for various LED samples and a solar reference spectrum. The datasets include wavelength-specific intensity measurements for multiple LED sources and a reference solar spectrum. Three Python scripts are provided to restructure, normalize, and analyze the data, ensuring consistency and enabling comparative analysis. The final output includes normalized SPD datasets and analysis results such as color metrics and plots.

## Files Included

### Data Files
1. **All LED_SPD (powers added).xlsx**
   - **Description**: Contains SPD data for 14 LED samples across wavelengths from approximately 178 nm to 1100 nm. The last row includes power consumption values (in watts) for each LED source.
   - **Columns**:
     - Wavelength: Wavelengths in nanometers (nm).
     - Aroosha, Donico, EDC, Hadid, HMD, Keihan, Khazashid, OMPg, Pars novin, Pars shoae toos, Ramin noor, Saierox, Pars shanaei, Pars afrooz: SPD intensity values for each LED sample.
     - Powers (last row): Power consumption in watts for each LED (e.g., 20 W for most, 10 W for Keihan, 18 W for Pars shanaei and Pars afrooz).
   - **Size**: 923 rows (922 data points + 1 power row).

2. **Refernce.xlsx**
   - **Description**: Contains the solar reference SPD data used for comparison with LED samples.
   - **Columns**:
     - Wavelength: Wavelengths in nanometers (nm).
     - Sun_Reference: SPD intensity values for the solar reference spectrum.
   - **Size**: Variable, but typically aligns with the LED wavelength range (178–1100 nm).

3. **Combined_SPD_Data for 1 w.xlsx**
   - **Description**: Intermediate output file generated by restructure_spd_data.py. Combines LED SPD data (normalized to 1 watt) and solar reference data into a unified format with integer wavelengths.
   - **Columns**:
     - Wavelength: Integer wavelengths (178–1100 nm).
     - Aroosha, Donico, ..., Pars afrooz: Normalized SPD intensities for each LED sample (per 1 watt).
     - Sun_Reference: Solar reference SPD intensities.
   - **Size**: 923 rows (one per integer wavelength from 178 to 1100 nm).

4. **Normalaized value and for 1 W.xlsx**
   - **Description**: Final normalized SPD data generated by normalize_spd_data.py. Each SPD curve is normalized such that its integral equals 1.
   - **Columns**: Same as Combined_SPD_Data for 1 w.xlsx.
   - **Size**: 923 rows.

5. **analysis_results.txt**
   - **Description**: Text file containing computed metrics from the analysis script.
   - **Content**: Metrics such as color temperature, CRI, luminous efficacy, etc., for each LED sample.

6. **plots/**
   - **Description**: Directory containing comparative plots of SPD curves and other visualizations generated by the analysis script.

### Python Scripts
1. **restructure_spd_data.py**
   - **Purpose**: Combines LED SPD data and reference data, normalizes LED intensities to a 1-watt basis, and aligns wavelengths to integers.
   - **Input**:
     - led_file: Path to All LED_SPD (powers added).xlsx.
     - reference_file: Path to Refernce.xlsx.
   - **Output**: Combined_SPD_Data for 1 w.xlsx.

2. **normalize_spd_data.py**
   - **Purpose**: Further normalizes the SPD data from Combined_SPD_Data for 1 w.xlsx so that the total power (integral) of each SPD curve equals 1.
   - **Input**: Combined_SPD_Data for 1 w.xlsx.
   - **Output**: Normalaized value and for 1 W.xlsx.

3. **analyze_led_spd.py**
   - **Purpose**: Analyzes the normalized SPD data to compute metrics such as color temperature, CRI, and luminous efficacy, and generates comparative plots.
   - **Input**: Normalaized value and for 1 W.xlsx.
   - **Output**: analysis_results.txt and plots in plots/ directory.

## Data Processing Workflow
1. **Raw Data Preparation**
   - Start with All LED_SPD (powers added).xlsx and Refernce.xlsx.
   - Ensure power values are correctly specified in the last row of the LED file.

2. **Restructuring and Initial Normalization**
   - Run restructure_spd_data.py:
   - - This script:
- Normalizes LED SPDs to 1 watt using the power values.
- Aligns all data to integer wavelengths (178–1100 nm).
- Combines LED and reference data into Combined_SPD_Data for 1 w.xlsx.

3. **Final Normalization**
- Run normalize_spd_data.py:
- - This script:
- Normalizes each SPD curve so its integral equals 1.
- Outputs the final dataset to Normalaized value and for 1 W.xlsx.

4. **Analyze LED SPD Data**
- Run analyze_led_spd.py:
- - This script:
- Loads the normalized SPD data from Normalaized value and for 1 W.xlsx.
- Computes metrics such as color temperature, CRI, and luminous efficacy for each LED sample.
- Generates comparative plots of SPD curves.
- Saves results to analysis_results.txt and plots to the plots/ directory.

## Usage Instructions

### Prerequisites
- **Python**: Version 3.6 or higher.
- **Libraries**: Install required packages:
- pip install pandas numpy openpyxl matplotlib
- 
### Running the Scripts
1. **Set File Paths**
 - Update the file paths in all three scripts to match your local directory structure:
   - In restructure_spd_data.py:
   - led_file = r"path\to\All LED_SPD (powers added).xlsx"
reference_file = r"path\to\Refernce.xlsx"
output_file = r"path\to\Combined_SPD_Data for 1 w.xlsx"
- In normalize_spd_data.py:
- file_path = r"path\to\Combined_SPD_Data for 1 w.xlsx"
output_path = r"path\to\Normalaized value and for 1 W.xlsx"
- In analyze_led_spd.py:
- input_file = r"path\to\Normalaized value and for 1 W.xlsx"
results_file = r"path\to\analysis_results.txt"
plots_dir = r"path\to\plots"

2. **Execute the Workflow**
- First, run restructure_spd_data.py to generate the intermediate file.
- Then, run normalize_spd_data.py to produce the final normalized dataset.
- Finally, run analyze_led_spd.py to perform the analysis and generate results.

### Output Verification
- Check **Combined_SPD_Data for 1 w.xlsx** for correct normalization to 1 watt (intensities should be smaller than raw data).
- Check **Normalaized value and for 1 W.xlsx** to ensure each SPD integrates to 1 (use a numerical integration tool if needed).
- Review **analysis_results.txt** for computed metrics and ensure plots in **plots/** are generated correctly.

## Notes
- **Wavelength Range**: The final dataset spans 178–1100 nm with 1 nm steps (923 unique wavelengths).
- **Power Values**: Ensure power values in All LED_SPD (powers added).xlsx are accurate, as they directly affect normalization.
- **Reference Data**: If Refernce.xlsx is unavailable, the script attempts to use a Sun_Reference column from the LED file or defaults to zeros.
- **Analysis Script**: Ensure that the analyze_led_spd.py script is configured correctly for your analysis needs. You may need to adjust parameters or functions within the script to compute specific metrics or generate desired plots.
- **Error Handling**: Scripts include basic error checking (e.g., NaN removal, invalid power values). Review console output for warnings.

## Contact
For questions or issues, please contact **Amir.fathabadi79@gmail.com**.
